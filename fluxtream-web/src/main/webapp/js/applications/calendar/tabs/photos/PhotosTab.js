define(["applications/calendar/tabs/Tab",
        "applications/calendar/App"], function(Tab, Calendar) {

    var maxWidth = 200;
    var maxHeight = 200;
    var ratio = maxWidth / maxHeight;
    var blah = "{\"tbounds\":{\"start\":1337572800000,\"end\":1337659199999},\"solarInfo\":{\"sunset\":1291,\"sunrise\":343},\"nApis\":7,\"updateNeeded\":[\"google_calendar\"],\"hasPictures\":false,\"addresses\":{},\"cities\":[{\"name\":\"Éghezée\",\"country\":\"Belgium\",\"count\":46,\"population\":0},{\"name\":\"Brussels\",\"country\":\"Belgium\",\"count\":16,\"population\":0},{\"name\":\"Murrysville\",\"country\":\"United States\",\"state\":\"PA\",\"count\":2,\"population\":0}],\"inTransit\":\"UNKNOWN\",\"travelType\":\"UNKNOWN\",\"minTempC\":12.0,\"maxTempC\":23.0,\"minTempF\":53.0,\"maxTempF\":74.0,\"settings\":{\"temperatureUnit\":\"FAHRENHEIT\",\"distanceUnit\":\"MILES_YARDS\"},\"haveDataConnectors\":[\"google_latitude\",\"google_calendar\",\"picasa\",\"lastfm\",\"withings\"],\"haveNoDataConnectors\":[\"twitter\",\"fitbit\"],\"selectedConnectors\":[{\"facetTypes\":[\"google_latitude\"],\"connectorName\":\"google_latitude\",\"prettyName\":\"Latitude\"},{\"facetTypes\":[\"fitbit\",\"fitbit-activity_summary\",\"fitbit-logged_activity\",\"fitbit-sleep\"],\"connectorName\":\"fitbit\",\"prettyName\":\"Fitbit\"},{\"facetTypes\":[\"bodytrack\"],\"connectorName\":\"bodytrack\",\"prettyName\":\"BodyTrack\"},{\"facetTypes\":[\"lastfm\",\"lastfm-loved_track\",\"lastfm-recent_track\"],\"connectorName\":\"lastfm\",\"prettyName\":\"Last FM\"},{\"facetTypes\":[\"withings\",\"withings-blood_pressure\",\"withings-weight\"],\"connectorName\":\"withings\",\"prettyName\":\"Withings\"},{\"facetTypes\":[\"picasa\",\"picasa-photo\"],\"connectorName\":\"picasa\",\"prettyName\":\"Picasa\"},{\"facetTypes\":[\"twitter\",\"twitter-tweet\",\"twitter-dm\",\"twitter-mention\"],\"connectorName\":\"twitter\",\"prettyName\":\"Twitter\"},{\"facetTypes\":[\"google_calendar\",\"google_calendar-entry\"],\"connectorName\":\"google_calendar\",\"prettyName\":\"Calendar\"}],\"hourlyWeatherData\":[{\"city\":\"Éghezée\",\"fdate\":\"2012-05-21\",\"minuteOfDay\":100,\"cloudcover\":100,\"humidity\":100,\"precipMM\":0.1,\"pressure\":1004,\"tempC\":13,\"tempF\":56,\"visibility\":0,\"weatherCode\":248,\"weatherDesc\":\"Fog\",\"weatherIconUrl\":\"/static/images/climacons/Fog.png\",\"weatherIconUrlDay\":\"/static/images/climacons/FS.png\",\"weatherIconUrlNight\":\"/static/images/climacons/FM.png\",\"winddirDegree\":359,\"windspeedKmph\":0,\"windspeedMiles\":6,\"id\":37468},{\"city\":\"Éghezée\",\"fdate\":\"2012-05-21\",\"minuteOfDay\":400,\"cloudcover\":100,\"humidity\":99,\"precipMM\":0.1,\"pressure\":1003,\"tempC\":12,\"tempF\":54,\"visibility\":0,\"weatherCode\":248,\"weatherDesc\":\"Fog\",\"weatherIconUrl\":\"/static/images/climacons/Fog.png\",\"weatherIconUrlDay\":\"/static/images/climacons/FS.png\",\"weatherIconUrlNight\":\"/static/images/climacons/FM.png\",\"winddirDegree\":344,\"windspeedKmph\":0,\"windspeedMiles\":6,\"id\":37469},{\"city\":\"Éghezée\",\"fdate\":\"2012-05-21\",\"minuteOfDay\":700,\"cloudcover\":93,\"humidity\":98,\"precipMM\":0.2,\"pressure\":1002,\"tempC\":13,\"tempF\":55,\"visibility\":2,\"weatherCode\":266,\"weatherDesc\":\"Light drizzle\",\"weatherIconUrl\":\"/static/images/climacons/CD.png\",\"weatherIconUrlDay\":\"/static/images/climacons/CDS.png\",\"weatherIconUrlNight\":\"/static/images/climacons/CDM.png\",\"winddirDegree\":340,\"windspeedKmph\":0,\"windspeedMiles\":7,\"id\":37470},{\"city\":\"Éghezée\",\"fdate\":\"2012-05-21\",\"minuteOfDay\":1000,\"cloudcover\":100,\"humidity\":96,\"precipMM\":0.2,\"pressure\":1002,\"tempC\":15,\"tempF\":58,\"visibility\":2,\"weatherCode\":266,\"weatherDesc\":\"Light drizzle\",\"weatherIconUrl\":\"/static/images/climacons/CD.png\",\"weatherIconUrlDay\":\"/static/images/climacons/CDS.png\",\"weatherIconUrlNight\":\"/static/images/climacons/CDM.png\",\"winddirDegree\":346,\"windspeedKmph\":0,\"windspeedMiles\":9,\"id\":37471},{\"city\":\"Éghezée\",\"fdate\":\"2012-05-21\",\"minuteOfDay\":1300,\"cloudcover\":100,\"humidity\":89,\"precipMM\":0.1,\"pressure\":1001,\"tempC\":19,\"tempF\":67,\"visibility\":10,\"weatherCode\":122,\"weatherDesc\":\"Overcast\",\"weatherIconUrl\":\"/static/images/climacons/Cloud.png\",\"weatherIconUrlDay\":\"/static/images/climacons/Cloud.png\",\"weatherIconUrlNight\":\"/static/images/climacons/Cloud.png\",\"winddirDegree\":352,\"windspeedKmph\":0,\"windspeedMiles\":10,\"id\":37472}],\"cachedData\":{\"google_latitude\":[{\"position\":[50.5833,4.9333],\"time\":\"03:46\",\"accuracy\":0,\"start\":1337586409849,\"startMinute\":226,\"type\":\"google_latitude\",\"id\":103826},{\"position\":[50.5833,4.9333],\"time\":\"03:47\",\"accuracy\":0,\"start\":1337586428726,\"startMinute\":227,\"type\":\"google_latitude\",\"id\":103959},{\"position\":[50.8576,4.39192],\"time\":\"01:28\",\"accuracy\":65,\"start\":1337578138967,\"startMinute\":88,\"type\":\"google_latitude\",\"id\":103988},{\"position\":[50.8576,4.39192],\"time\":\"01:28\",\"accuracy\":65,\"start\":1337578086095,\"startMinute\":88,\"type\":\"google_latitude\",\"id\":103989},{\"position\":[50.8576,4.39192],\"time\":\"01:25\",\"accuracy\":65,\"start\":1337577905333,\"startMinute\":85,\"type\":\"google_latitude\",\"id\":103990},{\"position\":[50.8576,4.39192],\"time\":\"01:22\",\"accuracy\":65,\"start\":1337577724568,\"startMinute\":82,\"type\":\"google_latitude\",\"id\":103991},{\"position\":[50.8577,4.39162],\"time\":\"01:19\",\"accuracy\":27,\"start\":1337577545132,\"startMinute\":79,\"type\":\"google_latitude\",\"id\":103992},{\"position\":[50.8678,4.39297],\"time\":\"01:16\",\"accuracy\":1414,\"start\":1337577363773,\"startMinute\":76,\"type\":\"google_latitude\",\"id\":103993},{\"position\":[50.8576,4.39192],\"time\":\"01:16\",\"accuracy\":65,\"start\":1337577363634,\"startMinute\":76,\"type\":\"google_latitude\",\"id\":103994},{\"position\":[50.8705,4.40104],\"time\":\"01:13\",\"accuracy\":1414,\"start\":1337577185246,\"startMinute\":73,\"type\":\"google_latitude\",\"id\":103995},{\"position\":[50.5833,4.9333],\"time\":\"03:47\",\"accuracy\":0,\"start\":1337586443387,\"startMinute\":227,\"type\":\"google_latitude\",\"id\":106041},{\"position\":[50.5833,4.9333],\"time\":\"04:17\",\"accuracy\":0,\"start\":1337588256885,\"startMinute\":257,\"type\":\"google_latitude\",\"id\":126661},{\"position\":[50.5833,4.9333],\"time\":\"04:17\",\"accuracy\":0,\"start\":1337588258762,\"startMinute\":257,\"type\":\"google_latitude\",\"id\":126662},{\"position\":[50.5833,4.9333],\"time\":\"04:40\",\"accuracy\":0,\"start\":1337589617396,\"startMinute\":280,\"type\":\"google_latitude\",\"id\":126663},{\"position\":[50.5833,4.9333],\"time\":\"04:54\",\"accuracy\":0,\"start\":1337590483248,\"startMinute\":294,\"type\":\"google_latitude\",\"id\":126664},{\"position\":[50.5833,4.9333],\"time\":\"04:54\",\"accuracy\":0,\"start\":1337590487608,\"startMinute\":294,\"type\":\"google_latitude\",\"id\":126665},{\"position\":[50.5833,4.9333],\"time\":\"07:21\",\"accuracy\":0,\"start\":1337599266710,\"startMinute\":441,\"type\":\"google_latitude\",\"id\":126666},{\"position\":[50.5833,4.9333],\"time\":\"07:22\",\"accuracy\":0,\"start\":1337599327429,\"startMinute\":442,\"type\":\"google_latitude\",\"id\":126667},{\"position\":[50.5833,4.9333],\"time\":\"07:30\",\"accuracy\":0,\"start\":1337599846973,\"startMinute\":450,\"type\":\"google_latitude\",\"id\":126668},{\"position\":[50.5833,4.9333],\"time\":\"07:49\",\"accuracy\":0,\"start\":1337600950374,\"startMinute\":469,\"type\":\"google_latitude\",\"id\":126669},{\"position\":[50.5833,4.9333],\"time\":\"07:54\",\"accuracy\":0,\"start\":1337601269682,\"startMinute\":474,\"type\":\"google_latitude\",\"id\":126670},{\"position\":[50.5833,4.9333],\"time\":\"07:55\",\"accuracy\":0,\"start\":1337601345224,\"startMinute\":475,\"type\":\"google_latitude\",\"id\":126671},{\"position\":[50.5833,4.9333],\"time\":\"08:07\",\"accuracy\":0,\"start\":1337602045834,\"startMinute\":487,\"type\":\"google_latitude\",\"id\":126672},{\"position\":[50.5833,4.9333],\"time\":\"08:10\",\"accuracy\":0,\"start\":1337602233339,\"startMinute\":490,\"type\":\"google_latitude\",\"id\":126673},{\"position\":[50.5833,4.9333],\"time\":\"08:16\",\"accuracy\":0,\"start\":1337602612844,\"startMinute\":496,\"type\":\"google_latitude\",\"id\":126674},{\"position\":[50.5833,4.9333],\"time\":\"08:37\",\"accuracy\":0,\"start\":1337603867118,\"startMinute\":517,\"type\":\"google_latitude\",\"id\":126675},{\"position\":[50.5833,4.9333],\"time\":\"09:06\",\"accuracy\":0,\"start\":1337605614249,\"startMinute\":546,\"type\":\"google_latitude\",\"id\":126676},{\"position\":[50.5833,4.9333],\"time\":\"09:10\",\"accuracy\":0,\"start\":1337605827737,\"startMinute\":550,\"type\":\"google_latitude\",\"id\":126677},{\"position\":[50.5833,4.9333],\"time\":\"09:23\",\"accuracy\":0,\"start\":1337606601903,\"startMinute\":563,\"type\":\"google_latitude\",\"id\":126678},{\"position\":[50.5833,4.9333],\"time\":\"09:26\",\"accuracy\":0,\"start\":1337606778909,\"startMinute\":566,\"type\":\"google_latitude\",\"id\":126679},{\"position\":[50.5833,4.9333],\"time\":\"09:26\",\"accuracy\":0,\"start\":1337606784034,\"startMinute\":566,\"type\":\"google_latitude\",\"id\":126680},{\"position\":[50.5833,4.9333],\"time\":\"09:37\",\"accuracy\":0,\"start\":1337607467807,\"startMinute\":577,\"type\":\"google_latitude\",\"id\":126681},{\"position\":[50.5833,4.9333],\"time\":\"09:54\",\"accuracy\":0,\"start\":1337608483418,\"startMinute\":594,\"type\":\"google_latitude\",\"id\":126682},{\"position\":[50.8576,4.39192],\"time\":\"12:44\",\"accuracy\":65,\"start\":1337618642079,\"startMinute\":764,\"type\":\"google_latitude\",\"id\":126683},{\"position\":[50.8576,4.39192],\"time\":\"12:43\",\"accuracy\":65,\"start\":1337618608432,\"startMinute\":763,\"type\":\"google_latitude\",\"id\":126684},{\"position\":[50.8333,4.3333],\"time\":\"17:17\",\"accuracy\":0,\"start\":1337635057425,\"startMinute\":1037,\"type\":\"google_latitude\",\"id\":126759},{\"position\":[50.8333,4.3333],\"time\":\"17:24\",\"accuracy\":0,\"start\":1337635468659,\"startMinute\":1044,\"type\":\"google_latitude\",\"id\":126764},{\"position\":[50.8333,4.3333],\"time\":\"17:24\",\"accuracy\":0,\"start\":1337635484784,\"startMinute\":1044,\"type\":\"google_latitude\",\"id\":126765},{\"position\":[50.8333,4.3333],\"time\":\"17:27\",\"accuracy\":0,\"start\":1337635677729,\"startMinute\":1047,\"type\":\"google_latitude\",\"id\":126766},{\"position\":[50.8333,4.3333],\"time\":\"17:28\",\"accuracy\":0,\"start\":1337635692571,\"startMinute\":1048,\"type\":\"google_latitude\",\"id\":126767},{\"position\":[40.4554,-79.66],\"time\":\"19:02\",\"accuracy\":0,\"start\":1337641362674,\"startMinute\":1142,\"type\":\"google_latitude\",\"id\":126768},{\"position\":[40.4554,-79.66],\"time\":\"22:28\",\"accuracy\":0,\"start\":1337653681579,\"startMinute\":1348,\"type\":\"google_latitude\",\"id\":126769}],\"withings-weight\":[{\"weight\":160.94,\"unitLabel\":\"lb\",\"daysAgo\":0,\"start\":1337581100000,\"startMinute\":138,\"type\":\"withings-weight\",\"description\":\"160.94 lb\",\"id\":1}],\"lastfm-recent_track\":[{\"artist\":\"Thundercat\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/68316160.png\"],\"start\":1337605894000,\"startMinute\":551,\"type\":\"lastfm-recent_track\",\"description\":\"Thundercat: Daylight\",\"id\":5052},{\"artist\":\"Jamie xx\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/66244004.jpg\"],\"start\":1337606075000,\"startMinute\":554,\"type\":\"lastfm-recent_track\",\"description\":\"Jamie xx: Far Nearer\",\"id\":5051},{\"artist\":\"Unknown Mortal Orchestra\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/68124220.png\"],\"start\":1337606487000,\"startMinute\":561,\"type\":\"lastfm-recent_track\",\"description\":\"Unknown Mortal Orchestra: FFunny FFriends\",\"id\":5056},{\"artist\":\"Liturgy\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/61615989.png\"],\"start\":1337606745000,\"startMinute\":565,\"type\":\"lastfm-recent_track\",\"description\":\"Liturgy: Generation\",\"id\":5055},{\"artist\":\"Yuck\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/58851523.png\"],\"start\":1337607173000,\"startMinute\":572,\"type\":\"lastfm-recent_track\",\"description\":\"Yuck: Get Away\",\"id\":5054},{\"artist\":\"Gang Gang Dance\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/62140549.png\"],\"start\":1337607388000,\"startMinute\":576,\"type\":\"lastfm-recent_track\",\"description\":\"Gang Gang Dance: Glass Jar\",\"id\":5053},{\"artist\":\"Real Estate\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/72863556.png\"],\"start\":1337608073000,\"startMinute\":587,\"type\":\"lastfm-recent_track\",\"description\":\"Real Estate: Green Aisles\",\"id\":5059},{\"artist\":\"Fleet Foxes\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/62605535.png\"],\"start\":1337609325000,\"startMinute\":608,\"type\":\"lastfm-recent_track\",\"description\":\"Fleet Foxes: Grown Ocean\",\"id\":5058},{\"artist\":\"Kreayshawn\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/65184940.png\"],\"start\":1337609602000,\"startMinute\":613,\"type\":\"lastfm-recent_track\",\"description\":\"Kreayshawn: Gucci Gucci\",\"id\":5057},{\"artist\":\"Bon Iver\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/65326430.png\"],\"start\":1337609807000,\"startMinute\":616,\"type\":\"lastfm-recent_track\",\"description\":\"Bon Iver: Holocene\",\"id\":5061},{\"artist\":\"Battles\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/74504984.png\"],\"start\":1337612291000,\"startMinute\":658,\"type\":\"lastfm-recent_track\",\"description\":\"Battles: Ice Cream (Featuring Matias Aguayo)\",\"id\":5060},{\"artist\":\"Gil Scott-Heron \\u0026 Jamie xx\",\"imgUrls\":[\"http://userserve-ak.last.fm/serve/34s/58964087.jpg\"],\"start\":1337612568000,\"startMinute\":662,\"type\":\"lastfm-recent_track\",\"description\":\"Gil Scott-Heron \\u0026 Jamie xx: I’ll Take Care Of U\",\"id\":5078}],\"google_calendar-entry\":[{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":84973},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":85116},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":85381},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":85582},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":85783},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":85983},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":86183},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":86383},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":86583},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":86783},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":86983},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":87183},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":87383},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":87583},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":87783},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":87983},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":88183},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":88383},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":88583},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":88783},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":88983},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":89183},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":89383},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":89583},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":89785},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":89985},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":90185},{\"title\":\"BT Weekly Group Meeting\",\"end\":1337630400000,\"endMinute\":960,\"start\":1337626800000,\"startMinute\":900,\"type\":\"google_calendar-entry\",\"description\":\"BT Weekly Group Meeting\",\"id\":90385}],\"picasa-photo\":[{\"thumbnailUrl\":\"https://lh5.googleusercontent.com/-ZYF5JzCsMoY/T7qpa_BHQRI/AAAAAAAADPs/zpufHVipZ00/s72/IMG_3933.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":48,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-ZYF5JzCsMoY/T7qpa_BHQRI/AAAAAAAADPs/zpufHVipZ00/s72/IMG_3933.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":96,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-ZYF5JzCsMoY/T7qpa_BHQRI/AAAAAAAADPs/zpufHVipZ00/s144/IMG_3933.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":192,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-ZYF5JzCsMoY/T7qpa_BHQRI/AAAAAAAADPs/zpufHVipZ00/s288/IMG_3933.jpg\\\"}]\",\"photoUrl\":\"https://lh5.googleusercontent.com/-ZYF5JzCsMoY/T7qpa_BHQRI/AAAAAAAADPs/zpufHVipZ00/IMG_3933.jpg\",\"start\":1337584206000,\"startMinute\":190,\"type\":\"picasa-photo\",\"id\":2809},{\"thumbnailUrl\":\"https://lh3.googleusercontent.com/-AoVuKpJd3Lg/T7qpaEl4GXI/AAAAAAAADPo/a9Saq3Mw_oE/s72/IMG_3934.JPG\",\"thumbnailsJson\":\"[{\\\"height\\\":54,\\\"width\\\":72,\\\"url\\\":\\\"https://lh3.googleusercontent.com/-AoVuKpJd3Lg/T7qpaEl4GXI/AAAAAAAADPo/a9Saq3Mw_oE/s72/IMG_3934.JPG\\\"},{\\\"height\\\":108,\\\"width\\\":144,\\\"url\\\":\\\"https://lh3.googleusercontent.com/-AoVuKpJd3Lg/T7qpaEl4GXI/AAAAAAAADPo/a9Saq3Mw_oE/s144/IMG_3934.JPG\\\"},{\\\"height\\\":216,\\\"width\\\":288,\\\"url\\\":\\\"https://lh3.googleusercontent.com/-AoVuKpJd3Lg/T7qpaEl4GXI/AAAAAAAADPo/a9Saq3Mw_oE/s288/IMG_3934.JPG\\\"}]\",\"photoUrl\":\"https://lh3.googleusercontent.com/-AoVuKpJd3Lg/T7qpaEl4GXI/AAAAAAAADPo/a9Saq3Mw_oE/IMG_3934.JPG\",\"start\":1337585712000,\"startMinute\":215,\"type\":\"picasa-photo\",\"id\":2813},{\"thumbnailUrl\":\"https://lh6.googleusercontent.com/-j_Lo1wqHmKc/T7qpY0QQvlI/AAAAAAAADPg/QjNUQDe1QN0/s72/IMG_3935.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":54,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-j_Lo1wqHmKc/T7qpY0QQvlI/AAAAAAAADPg/QjNUQDe1QN0/s72/IMG_3935.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":108,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-j_Lo1wqHmKc/T7qpY0QQvlI/AAAAAAAADPg/QjNUQDe1QN0/s144/IMG_3935.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":216,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-j_Lo1wqHmKc/T7qpY0QQvlI/AAAAAAAADPg/QjNUQDe1QN0/s288/IMG_3935.jpg\\\"}]\",\"photoUrl\":\"https://lh6.googleusercontent.com/-j_Lo1wqHmKc/T7qpY0QQvlI/AAAAAAAADPg/QjNUQDe1QN0/IMG_3935.jpg\",\"start\":1337586294000,\"startMinute\":224,\"type\":\"picasa-photo\",\"id\":2807},{\"thumbnailUrl\":\"https://lh5.googleusercontent.com/-sP6R4aZ3HF8/T7qpXIwuv9I/AAAAAAAADPY/5JKhyUyLfeE/s72/IMG_3936.JPG\",\"thumbnailsJson\":\"[{\\\"height\\\":54,\\\"width\\\":72,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-sP6R4aZ3HF8/T7qpXIwuv9I/AAAAAAAADPY/5JKhyUyLfeE/s72/IMG_3936.JPG\\\"},{\\\"height\\\":108,\\\"width\\\":144,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-sP6R4aZ3HF8/T7qpXIwuv9I/AAAAAAAADPY/5JKhyUyLfeE/s144/IMG_3936.JPG\\\"},{\\\"height\\\":216,\\\"width\\\":288,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-sP6R4aZ3HF8/T7qpXIwuv9I/AAAAAAAADPY/5JKhyUyLfeE/s288/IMG_3936.JPG\\\"}]\",\"photoUrl\":\"https://lh5.googleusercontent.com/-sP6R4aZ3HF8/T7qpXIwuv9I/AAAAAAAADPY/5JKhyUyLfeE/IMG_3936.JPG\",\"start\":1337586351000,\"startMinute\":225,\"type\":\"picasa-photo\",\"id\":2815},{\"thumbnailUrl\":\"https://lh4.googleusercontent.com/-dgCSQGRA_5A/T7qpVulPz-I/AAAAAAAADPQ/qtJc1o9v17k/s72/IMG_3937.JPG\",\"thumbnailsJson\":\"[{\\\"height\\\":54,\\\"width\\\":72,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-dgCSQGRA_5A/T7qpVulPz-I/AAAAAAAADPQ/qtJc1o9v17k/s72/IMG_3937.JPG\\\"},{\\\"height\\\":108,\\\"width\\\":144,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-dgCSQGRA_5A/T7qpVulPz-I/AAAAAAAADPQ/qtJc1o9v17k/s144/IMG_3937.JPG\\\"},{\\\"height\\\":216,\\\"width\\\":288,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-dgCSQGRA_5A/T7qpVulPz-I/AAAAAAAADPQ/qtJc1o9v17k/s288/IMG_3937.JPG\\\"}]\",\"photoUrl\":\"https://lh4.googleusercontent.com/-dgCSQGRA_5A/T7qpVulPz-I/AAAAAAAADPQ/qtJc1o9v17k/IMG_3937.JPG\",\"start\":1337588137000,\"startMinute\":255,\"type\":\"picasa-photo\",\"id\":2805},{\"thumbnailUrl\":\"https://lh5.googleusercontent.com/-cdSIf7oxXxc/T7qpT3Qzr_I/AAAAAAAADPI/vAGAlKfZLNg/s72/IMG_3938.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":54,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-cdSIf7oxXxc/T7qpT3Qzr_I/AAAAAAAADPI/vAGAlKfZLNg/s72/IMG_3938.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":108,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-cdSIf7oxXxc/T7qpT3Qzr_I/AAAAAAAADPI/vAGAlKfZLNg/s144/IMG_3938.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":216,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-cdSIf7oxXxc/T7qpT3Qzr_I/AAAAAAAADPI/vAGAlKfZLNg/s288/IMG_3938.jpg\\\"}]\",\"photoUrl\":\"https://lh5.googleusercontent.com/-cdSIf7oxXxc/T7qpT3Qzr_I/AAAAAAAADPI/vAGAlKfZLNg/IMG_3938.jpg\",\"start\":1337599301000,\"startMinute\":441,\"type\":\"picasa-photo\",\"id\":2806},{\"thumbnailUrl\":\"https://lh4.googleusercontent.com/-aSe3mzoO4Yg/T7qpS8n2XsI/AAAAAAAADPA/1pvrWQ08t94/s72/IMG_3939.JPG\",\"thumbnailsJson\":\"[{\\\"height\\\":54,\\\"width\\\":72,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-aSe3mzoO4Yg/T7qpS8n2XsI/AAAAAAAADPA/1pvrWQ08t94/s72/IMG_3939.JPG\\\"},{\\\"height\\\":108,\\\"width\\\":144,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-aSe3mzoO4Yg/T7qpS8n2XsI/AAAAAAAADPA/1pvrWQ08t94/s144/IMG_3939.JPG\\\"},{\\\"height\\\":216,\\\"width\\\":288,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-aSe3mzoO4Yg/T7qpS8n2XsI/AAAAAAAADPA/1pvrWQ08t94/s288/IMG_3939.JPG\\\"}]\",\"photoUrl\":\"https://lh4.googleusercontent.com/-aSe3mzoO4Yg/T7qpS8n2XsI/AAAAAAAADPA/1pvrWQ08t94/IMG_3939.JPG\",\"start\":1337603830000,\"startMinute\":517,\"type\":\"picasa-photo\",\"id\":2801},{\"thumbnailUrl\":\"https://lh6.googleusercontent.com/-ykC8UZ2O7X4/T7qpRv4Bm_I/AAAAAAAADO4/5og1phOohI8/s72/IMG_3940.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":54,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-ykC8UZ2O7X4/T7qpRv4Bm_I/AAAAAAAADO4/5og1phOohI8/s72/IMG_3940.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":108,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-ykC8UZ2O7X4/T7qpRv4Bm_I/AAAAAAAADO4/5og1phOohI8/s144/IMG_3940.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":216,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-ykC8UZ2O7X4/T7qpRv4Bm_I/AAAAAAAADO4/5og1phOohI8/s288/IMG_3940.jpg\\\"}]\",\"photoUrl\":\"https://lh6.googleusercontent.com/-ykC8UZ2O7X4/T7qpRv4Bm_I/AAAAAAAADO4/5og1phOohI8/IMG_3940.jpg\",\"start\":1337623272000,\"startMinute\":841,\"type\":\"picasa-photo\",\"id\":2800},{\"thumbnailUrl\":\"https://lh5.googleusercontent.com/-Ut6xBouleTM/T7qpQy6nGZI/AAAAAAAADOs/yz1h0sNq22U/s72/IMG_3941.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":48,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-Ut6xBouleTM/T7qpQy6nGZI/AAAAAAAADOs/yz1h0sNq22U/s72/IMG_3941.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":96,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-Ut6xBouleTM/T7qpQy6nGZI/AAAAAAAADOs/yz1h0sNq22U/s144/IMG_3941.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":192,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-Ut6xBouleTM/T7qpQy6nGZI/AAAAAAAADOs/yz1h0sNq22U/s288/IMG_3941.jpg\\\"}]\",\"photoUrl\":\"https://lh5.googleusercontent.com/-Ut6xBouleTM/T7qpQy6nGZI/AAAAAAAADOs/yz1h0sNq22U/IMG_3941.jpg\",\"start\":1337629544000,\"startMinute\":945,\"type\":\"picasa-photo\",\"id\":2797},{\"thumbnailUrl\":\"https://lh6.googleusercontent.com/-uS-UbCYXbmM/T7qpQFJzK5I/AAAAAAAADOo/5tkqVAr0UuE/s72/IMG_3942.JPG\",\"thumbnailsJson\":\"[{\\\"height\\\":54,\\\"width\\\":72,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-uS-UbCYXbmM/T7qpQFJzK5I/AAAAAAAADOo/5tkqVAr0UuE/s72/IMG_3942.JPG\\\"},{\\\"height\\\":108,\\\"width\\\":144,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-uS-UbCYXbmM/T7qpQFJzK5I/AAAAAAAADOo/5tkqVAr0UuE/s144/IMG_3942.JPG\\\"},{\\\"height\\\":216,\\\"width\\\":288,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-uS-UbCYXbmM/T7qpQFJzK5I/AAAAAAAADOo/5tkqVAr0UuE/s288/IMG_3942.JPG\\\"}]\",\"photoUrl\":\"https://lh6.googleusercontent.com/-uS-UbCYXbmM/T7qpQFJzK5I/AAAAAAAADOo/5tkqVAr0UuE/IMG_3942.JPG\",\"start\":1337629635000,\"startMinute\":947,\"type\":\"picasa-photo\",\"id\":2819},{\"thumbnailUrl\":\"https://lh6.googleusercontent.com/-YVl5c7J51Bk/T7qpOojZaFI/AAAAAAAADOg/Q-Q46cpVmE0/s72/IMG_3943.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":54,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-YVl5c7J51Bk/T7qpOojZaFI/AAAAAAAADOg/Q-Q46cpVmE0/s72/IMG_3943.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":108,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-YVl5c7J51Bk/T7qpOojZaFI/AAAAAAAADOg/Q-Q46cpVmE0/s144/IMG_3943.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":216,\\\"url\\\":\\\"https://lh6.googleusercontent.com/-YVl5c7J51Bk/T7qpOojZaFI/AAAAAAAADOg/Q-Q46cpVmE0/s288/IMG_3943.jpg\\\"}]\",\"photoUrl\":\"https://lh6.googleusercontent.com/-YVl5c7J51Bk/T7qpOojZaFI/AAAAAAAADOg/Q-Q46cpVmE0/IMG_3943.jpg\",\"start\":1337630870000,\"startMinute\":967,\"type\":\"picasa-photo\",\"id\":2821},{\"thumbnailUrl\":\"https://lh3.googleusercontent.com/-Xv_IezOu5sQ/T7qq6XbLcdI/AAAAAAAADZA/ZpHi47JujkE/s72/Screen%252520shot%2525202012-05-21%252520at%2525208.18.35%252520PM.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":43,\\\"width\\\":72,\\\"url\\\":\\\"https://lh3.googleusercontent.com/-Xv_IezOu5sQ/T7qq6XbLcdI/AAAAAAAADZA/ZpHi47JujkE/s72/Screen%252520shot%2525202012-05-21%252520at%2525208.18.35%252520PM.jpg\\\"},{\\\"height\\\":86,\\\"width\\\":144,\\\"url\\\":\\\"https://lh3.googleusercontent.com/-Xv_IezOu5sQ/T7qq6XbLcdI/AAAAAAAADZA/ZpHi47JujkE/s144/Screen%252520shot%2525202012-05-21%252520at%2525208.18.35%252520PM.jpg\\\"},{\\\"height\\\":172,\\\"width\\\":288,\\\"url\\\":\\\"https://lh3.googleusercontent.com/-Xv_IezOu5sQ/T7qq6XbLcdI/AAAAAAAADZA/ZpHi47JujkE/s288/Screen%252520shot%2525202012-05-21%252520at%2525208.18.35%252520PM.jpg\\\"}]\",\"photoUrl\":\"https://lh3.googleusercontent.com/-Xv_IezOu5sQ/T7qq6XbLcdI/AAAAAAAADZA/ZpHi47JujkE/Screen%252520shot%2525202012-05-21%252520at%2525208.18.35%252520PM.jpg\",\"start\":1337631521000,\"startMinute\":978,\"type\":\"picasa-photo\",\"id\":2724},{\"thumbnailUrl\":\"https://lh5.googleusercontent.com/-T30Czs1h_Tk/T7qpMeOlYEI/AAAAAAAADOY/zY0gs0bn53k/s72/IMG_3944.JPG\",\"thumbnailsJson\":\"[{\\\"height\\\":54,\\\"width\\\":72,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-T30Czs1h_Tk/T7qpMeOlYEI/AAAAAAAADOY/zY0gs0bn53k/s72/IMG_3944.JPG\\\"},{\\\"height\\\":108,\\\"width\\\":144,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-T30Czs1h_Tk/T7qpMeOlYEI/AAAAAAAADOY/zY0gs0bn53k/s144/IMG_3944.JPG\\\"},{\\\"height\\\":216,\\\"width\\\":288,\\\"url\\\":\\\"https://lh5.googleusercontent.com/-T30Czs1h_Tk/T7qpMeOlYEI/AAAAAAAADOY/zY0gs0bn53k/s288/IMG_3944.JPG\\\"}]\",\"photoUrl\":\"https://lh5.googleusercontent.com/-T30Czs1h_Tk/T7qpMeOlYEI/AAAAAAAADOY/zY0gs0bn53k/IMG_3944.JPG\",\"start\":1337632603000,\"startMinute\":996,\"type\":\"picasa-photo\",\"id\":2822},{\"thumbnailUrl\":\"https://lh4.googleusercontent.com/-OIQxSdieS-0/T7qpKjVneBI/AAAAAAAADOQ/iFpWDB3s4UU/s72/IMG_3945.jpg\",\"thumbnailsJson\":\"[{\\\"height\\\":72,\\\"width\\\":48,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-OIQxSdieS-0/T7qpKjVneBI/AAAAAAAADOQ/iFpWDB3s4UU/s72/IMG_3945.jpg\\\"},{\\\"height\\\":144,\\\"width\\\":96,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-OIQxSdieS-0/T7qpKjVneBI/AAAAAAAADOQ/iFpWDB3s4UU/s144/IMG_3945.jpg\\\"},{\\\"height\\\":288,\\\"width\\\":192,\\\"url\\\":\\\"https://lh4.googleusercontent.com/-OIQxSdieS-0/T7qpKjVneBI/AAAAAAAADOQ/iFpWDB3s4UU/s288/IMG_3945.jpg\\\"}]\",\"photoUrl\":\"https://lh4.googleusercontent.com/-OIQxSdieS-0/T7qpKjVneBI/AAAAAAAADOQ/iFpWDB3s4UU/IMG_3945.jpg\",\"start\":1337635810000,\"startMinute\":1050,\"type\":\"picasa-photo\",\"id\":2820}]}}";

    function render(dgest, timeUnit, calendarState, cEn) {
        this.getTemplate("text!applications/calendar/tabs/photos/photos.html", "photos", function() {
            digest = dgest;
            connectorEnabled = cEn;
            setup(digest,connectorEnabled);
        });
    }

    /*function render(digest, timeUnit) {
        this.getUrl("/tabs/photos", "photos", null, true);
    }*/

    var connectorEnabled;
    var digest;

    function setup(digest, cEn){
        digest = JSON.parse(blah);
        if (digest.cachedData["picasa-photo"] == null){
            showNoPhotos();
            return;
        }

        var count = 0;
        for (var i = 0; i < digest.cachedData["picasa-photo"].length; i++){
            $("<img src='" + digest.cachedData["picasa-photo"][i].photoUrl + "'>").load({i:i},function(event){
                var i = event.data.i;
                digest.cachedData["picasa-photo"][i].width = event.target.width;
                digest.cachedData["picasa-photo"][i].height = event.target.height;
                digest.cachedData["picasa-photo"][i].ratio = event.target.width / event.target.height;
                count++;
                if (count == digest.cachedData["picasa-photo"].length)
                    onDataRecieved(digest.cachedData["picasa-photo"]);

            });

        }
    }

    function showNoPhotos(){
        $("#photoTab").empty();
        $("#photoTab").append("<div class=\"emptyList\">(no photos)</div>");
    }

    function onDataRecieved(photos){
        for (var i = 0; i < photos.length; i++){
            photos[i].targetHeight = photos[i].height;
            photos[i].targetWidth = photos[i].width;
            if (photos[i].ratio < ratio){//check height
                if (photos[i].height > maxHeight){
                    photos[i].targetHeight = maxHeight;
                    photos[i].targetWidth = photos[i].width * photos[i].targetHeight / photos[i].height;
                }
            }
            else if (photos[i].width > maxWidth){
                photos[i].targetWidth = maxWidth;
                photos[i].targetHeight = photos[i].height * photos[i].targetWidth / photos[i].width;

            }
        }
        var data = [];
        $("#photoTab").empty();
        for (var i = 0; i < photos.length; i++){
            for (var j = 0; j < digest.selectedConnectors.length; j++){
                var found = false;
                for (var k = 0; !found &&  k < digest.selectedConnectors[j].facetTypes.length; k++){
                   found = digest.selectedConnectors[j].facetTypes[k] == photos[i].type;
                }
                if (found){
                   if (connectorEnabled[digest.selectedConnectors[j].connectorName])
                        data[data.length] = photos[i];
                }
            }
        }
        for (var i = 0; i < data.length; i++){
            data[i].active = i == 0;
            data[i].id = i;
        }
        $("#photoTab").empty();
        if (data.length == 0){
            showNoPhotos();
            return;
        }
        App.loadMustacheTemplate("applications/calendar/tabs/photos/photosTemplate.html","carousel",function(template){
            var carouselHTML = template.render({photos:data,includeNav:data.length > 1});
            App.loadMustacheTemplate("applications/calendar/tabs/photos/photosTemplate.html","thumbnailGroup", function(template){
                var currentGroup = [];
                var currentDate = null;
                for (var i = 0; i < data.length; i++){
                   var date = new Date(data[i].start);
                   if (currentDate == null){
                       currentDate = date;
                   }
                   else if (currentDate.getMonth() != date.getMonth() || currentDate.getYear() != date.getYear()
                       || currentDate.getDate() != date.getDate()) {
                       $("#photoTab").append(template.render({date:App.formatDate(currentDate),photos:currentGroup}));
                       currentGroup = [];
                       currentDate = date;
                   }
                    currentGroup[currentGroup.length] = data[i];
                }
                if (currentGroup.length != 0){
                    $("#photoTab").append(template.render({date:App.formatDate(currentDate),photos:currentGroup}));
                }
                for (var i = 0; i < data.length; i++){
                    $("#photo-" + i).click({i:i},function(event){
                        App.makeModal(carouselHTML);
                        App.carousel(event.data.i);
                    });
                }
                var groups = $(".thumbnailGroup");
                for (var i = 0; i < groups.length; i++){
                    $(groups[i]).masonry({
                         itemSelector: '.thumbnailContainer',
                         columnWidth:1
                     });
                }
            });

        });

    }

    function connectorToggled(connectorName,objectTypeNames,enabled){
        connectorEnabled[connectorName] = enabled;
        setup(digest,connectorEnabled);
    }

    var photosTab = new Tab("photos", "Candide Kemmler", "icon-camera", true);
    photosTab.render = render;
    photosTab.connectorToggled = connectorToggled;
    return photosTab;

});

